{"version":3,"file":"index.modern.js","sources":["../src/index.js"],"sourcesContent":["import { Controller } from '@hotwired/stimulus';\nimport '@kanety/stimulus-static-actions';\nimport './index.scss';\n\nexport default class extends Controller {\n  static targets = ['drop', 'helper'];\n  static actions = [\n    ['element', 'dragstart@document->start']\n  ];\n  static dragActions = [\n    ['element', 'dragenter@document->enter'],\n    ['element', 'dragover@document->over'],\n    ['element', 'dragleave@document->leave'],\n    ['element', 'drag@document->drag'],\n    ['element', 'drop@document->drop'],\n    ['element', 'dragend@document->end']\n  ];\n\n  get draggers() {\n    return this.scope.findAllElements('[draggable=\"true\"]');\n  }\n\n  start(e) {\n    this.currentDrag = this.draggers.find(drag => drag.contains(e.target));\n    if (this.currentDrag) {\n      this.toggleClass(true);\n      this.showHelper(e.pageX, e.pageY);\n      this.dispatch('start', { detail: { dataTransfer: e.dataTransfer, drag: this.currentDrag } });\n      this.context.actionSet.add(this.constructor.dragActions);\n    }\n  }\n\n  enter(e) {\n    let drop = this.findCurrentDrop(e.target);\n    if (drop) {\n      this.toggleOverClass(drop, true)\n      this.dispatch('enter', { detail: { dataTransfer: e.dataTransfer, drag: this.currentDrag, drop: drop } });\n    }\n    e.preventDefault();\n  }\n\n  over(e) {\n    let drop = this.findCurrentDrop(e.target);\n    if (drop) {\n      this.dispatch('over', { detail: { dataTransfer: e.dataTransfer, drag: this.currentDrag, drop: drop } });\n    }\n    e.preventDefault();\n  }\n\n  leave(e) {\n    let drop = this.findCurrentDrop(e.target);\n    if (drop) {\n      this.toggleOverClass(drop, false)\n      this.dispatch('leave', { detail: { dataTransfer: e.dataTransfer, drag: this.currentDrag, drop: drop } });\n    }\n  }\n\n  drag(e) {\n    this.moveHelper(e.pageX, e.pageY);\n    this.dispatch('drag', { detail: { dataTransfer: e.dataTransfer, drag: this.currentDrag } });\n  }\n\n  drop(e) {\n    let drop = this.findCurrentDrop(e.target);\n    if (drop) {\n      this.dispatch('drop', { detail: { dataTransfer: e.dataTransfer, drag: this.currentDrag, drop: drop } });\n    }\n  }\n\n  end(e) {\n    this.toggleClass(false);\n    this.hideHelper();\n    this.dispatch('end', { detail: { dataTransfer: e.dataTransfer, drag: this.currentDrag } });\n    this.context.actionSet.remove(this.constructor.dragActions);\n  }\n\n  findCurrentDrop(target) {\n    return this.dropTargets.find(drop => drop.contains(target));\n  }\n\n  toggleClass(dragging) {\n    if (dragging) {\n      this.dropTargets.forEach(drop => {\n        drop.classList.add('st-droppable__drop--ok');\n      });\n    } else {\n      this.dropTargets.forEach(drop => {\n        drop.classList.remove('st-droppable__drop--ok');\n        drop.classList.remove('st-droppable__drop--over');\n      });\n    }\n  }\n\n  toggleOverClass(drop, dragging) {\n    if (dragging) {\n      drop.classList.add('st-droppable__drop--over');\n    } else {\n      drop.classList.remove('st-droppable__drop--over');\n    }\n  }\n\n  showHelper(x, y) {\n    if (this.hasHelperTarget) {\n      this.helperTarget.style.display = '';\n      this.moveHelper(x, y);    \n    }\n  }\n\n  moveHelper(x, y) {\n    if (this.hasHelperTarget && x && y) {\n      this.helperTarget.style.top = y + 10 + 'px';\n      this.helperTarget.style.left = x + 'px';\n    }\n  }\n\n  hideHelper() {\n    if (this.hasHelperTarget) {\n      this.helperTarget.style.display = 'none';\n    }\n  }\n}\n"],"names":["Controller","draggers","scope","findAllElements","start","e","this","currentDrag","find","drag","contains","target","toggleClass","showHelper","pageX","pageY","dispatch","detail","dataTransfer","context","actionSet","add","constructor","dragActions","enter","drop","findCurrentDrop","toggleOverClass","preventDefault","over","leave","moveHelper","end","hideHelper","remove","dropTargets","dragging","forEach","classList","x","y","hasHelperTarget","helperTarget","style","display","top","left","targets","actions"],"mappings":"wGAI6BA,EAcvBC,eACF,YAAYC,MAAMC,gBAAgB,sBAGpCC,MAAMC,GACJC,KAAKC,YAAcD,KAAKL,SAASO,KAAKC,GAAQA,EAAKC,SAASL,EAAEM,SAC1DL,KAAKC,cACPD,KAAKM,aAAY,GACjBN,KAAKO,WAAWR,EAAES,MAAOT,EAAEU,OAC3BT,KAAKU,SAAS,QAAS,CAAEC,OAAQ,CAAEC,aAAcb,EAAEa,aAAcT,KAAMH,KAAKC,eAC5ED,KAAKa,QAAQC,UAAUC,IAAIf,KAAKgB,YAAYC,cAIhDC,MAAMnB,GACJ,IAAIoB,EAAOnB,KAAKoB,gBAAgBrB,EAAEM,QAC9Bc,IACFnB,KAAKqB,gBAAgBF,GAAM,GAC3BnB,KAAKU,SAAS,QAAS,CAAEC,OAAQ,CAAEC,aAAcb,EAAEa,aAAcT,KAAMH,KAAKC,YAAakB,KAAMA,MAEjGpB,EAAEuB,iBAGJC,KAAKxB,GACH,IAAIoB,EAAOnB,KAAKoB,gBAAgBrB,EAAEM,QAC9Bc,GACFnB,KAAKU,SAAS,OAAQ,CAAEC,OAAQ,CAAEC,aAAcb,EAAEa,aAAcT,KAAMH,KAAKC,YAAakB,KAAMA,KAEhGpB,EAAEuB,iBAGJE,MAAMzB,GACJ,IAAIoB,EAAOnB,KAAKoB,gBAAgBrB,EAAEM,QAC9Bc,IACFnB,KAAKqB,gBAAgBF,GAAM,GAC3BnB,KAAKU,SAAS,QAAS,CAAEC,OAAQ,CAAEC,aAAcb,EAAEa,aAAcT,KAAMH,KAAKC,YAAakB,KAAMA,MAInGhB,KAAKJ,GACHC,KAAKyB,WAAW1B,EAAES,MAAOT,EAAEU,OAC3BT,KAAKU,SAAS,OAAQ,CAAEC,OAAQ,CAAEC,aAAcb,EAAEa,aAAcT,KAAMH,KAAKC,eAG7EkB,KAAKpB,GACH,IAAIoB,EAAOnB,KAAKoB,gBAAgBrB,EAAEM,QAC9Bc,GACFnB,KAAKU,SAAS,OAAQ,CAAEC,OAAQ,CAAEC,aAAcb,EAAEa,aAAcT,KAAMH,KAAKC,YAAakB,KAAMA,KAIlGO,IAAI3B,GACFC,KAAKM,aAAY,GACjBN,KAAK2B,aACL3B,KAAKU,SAAS,MAAO,CAAEC,OAAQ,CAAEC,aAAcb,EAAEa,aAAcT,KAAMH,KAAKC,eAC1ED,KAAKa,QAAQC,UAAUc,OAAO5B,KAAKgB,YAAYC,aAGjDG,gBAAgBf,GACd,YAAYwB,YAAY3B,KAAKiB,GAAQA,EAAKf,SAASC,IAGrDC,YAAYwB,GAER9B,KAAK6B,YAAYE,QADfD,EACuBX,IACvBA,EAAKa,UAAUjB,IAAI,2BAGII,IACvBA,EAAKa,UAAUJ,OAAO,0BACtBT,EAAKa,UAAUJ,OAAO,8BAK5BP,gBAAgBF,EAAMW,GAChBA,EACFX,EAAKa,UAAUjB,IAAI,4BAEnBI,EAAKa,UAAUJ,OAAO,4BAI1BrB,WAAW0B,EAAGC,GACRlC,KAAKmC,kBACPnC,KAAKoC,aAAaC,MAAMC,QAAU,GAClCtC,KAAKyB,WAAWQ,EAAGC,IAIvBT,WAAWQ,EAAGC,GACRlC,KAAKmC,iBAAmBF,GAAKC,IAC/BlC,KAAKoC,aAAaC,MAAME,IAAML,EAAI,GAAK,KACvClC,KAAKoC,aAAaC,MAAMG,KAAOP,EAAI,MAIvCN,aACM3B,KAAKmC,kBACPnC,KAAKoC,aAAaC,MAAMC,QAAU,WAhH/BG,QAAU,CAAC,OAAQ,YACnBC,QAAU,CACf,CAAC,UAAW,gCAEPzB,YAAc,CACnB,CAAC,UAAW,6BACZ,CAAC,UAAW,2BACZ,CAAC,UAAW,6BACZ,CAAC,UAAW,uBACZ,CAAC,UAAW,uBACZ,CAAC,UAAW"}