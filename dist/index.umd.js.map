{"version":3,"file":"index.umd.js","sources":["../src/index.js"],"sourcesContent":["import { Controller } from '@hotwired/stimulus';\nimport '@kanety/stimulus-static-actions';\nimport './index.scss';\n\nexport default class extends Controller {\n  static targets = ['drop'];\n  static actions = [\n    ['element', 'dragstart@document->start']\n  ];\n  static dragActions = [\n    ['element', 'dragenter@document->enter'],\n    ['element', 'dragover@document->over'],\n    ['element', 'dragleave@document->leave'],\n    ['element', 'drag@document->drag'],\n    ['element', 'drop@document->drop'],\n    ['element', 'dragend@document->end']\n  ];\n\n  get draggers() {\n    return this.scope.findAllElements('[draggable=\"true\"]');\n  }\n\n  start(e) {\n    this.currentDrag = this.draggers.find(drag => drag == e.target);\n    if (this.currentDrag) {\n      this.toggleClass(true);\n      this.dispatch('start', { detail: { event: e, drag: this.currentDrag } });\n      this.context.actionSet.add(this.constructor.dragActions);\n      e.dataTransfer.setDragImage(new Image(), 0, 0)\n    }\n  }\n\n  enter(e) {\n    let drop = this.findCurrentDrop(e.target);\n    if (drop) {\n      drop.classList.add('st-droppable__drop--current');\n      this.dispatch('enter', { detail: { event: e, drag: this.currentDrag, drop: drop } });\n    }\n    e.preventDefault();\n  }\n\n  over(e) {\n    let drop = this.findCurrentDrop(e.target);\n    if (drop) {\n      this.dispatch('over', { detail: { event: e, drag: this.currentDrag, drop: drop } });\n    }\n    e.preventDefault();\n  }\n\n  leave(e) {\n    let drop = this.findCurrentDrop(e.target);\n    if (drop) {\n      drop.classList.remove('st-droppable__drop--current');\n      this.dispatch('leave', { detail: { event: e, drag: this.currentDrag, drop: drop } });\n    }\n  }\n\n  drag(e) {\n    this.dispatch('drag', { detail: { event: e, drag: this.currentDrag } });\n  }\n\n  drop(e) {\n    let drop = this.findCurrentDrop(e.target);\n    if (drop) {\n      this.dispatch('drop', { detail: { event: e, drag: this.currentDrag, drop: drop } });\n    }\n  }\n\n  end(e) {\n    this.toggleClass(false);\n    this.dispatch('end', { detail: { event: e, drag: this.currentDrag } });\n    this.context.actionSet.remove(this.constructor.dragActions);\n  }\n\n  findCurrentDrop(target) {\n    return this.dropTargets.find(drop => drop.contains(target));\n  }\n\n  toggleClass(dragging) {\n    if (dragging) {\n      this.dropTargets.forEach(drop => {\n        drop.classList.add('st-droppable__drop');\n      });\n    } else {\n      this.dropTargets.forEach(drop => {\n        drop.classList.remove('st-droppable__drop');\n        drop.classList.remove('st-droppable__drop--current');\n      });\n    }\n  }\n}\n"],"names":["Controller","draggers","scope","findAllElements","start","e","this","currentDrag","find","drag","target","toggleClass","dispatch","detail","event","context","actionSet","add","constructor","dragActions","dataTransfer","setDragImage","Image","enter","drop","findCurrentDrop","classList","preventDefault","over","leave","remove","end","dropTargets","contains","dragging","forEach","targets","actions"],"mappings":"gYAI6BA,aAcvBC,eACF,YAAYC,MAAMC,gBAAgB,sBAGpCC,MAAMC,GACJC,KAAKC,YAAcD,KAAKL,SAASO,KAAKC,GAAQA,GAAQJ,EAAEK,QACpDJ,KAAKC,cACPD,KAAKK,aAAY,GACjBL,KAAKM,SAAS,QAAS,CAAEC,OAAQ,CAAEC,MAAOT,EAAGI,KAAMH,KAAKC,eACxDD,KAAKS,QAAQC,UAAUC,IAAIX,KAAKY,YAAYC,aAC5Cd,EAAEe,aAAaC,aAAa,IAAIC,MAAS,EAAG,IAIhDC,MAAMlB,GACJ,IAAImB,EAAOlB,KAAKmB,gBAAgBpB,EAAEK,QAC9Bc,IACFA,EAAKE,UAAUT,IAAI,+BACnBX,KAAKM,SAAS,QAAS,CAAEC,OAAQ,CAAEC,MAAOT,EAAGI,KAAMH,KAAKC,YAAaiB,KAAMA,MAE7EnB,EAAEsB,iBAGJC,KAAKvB,GACH,IAAImB,EAAOlB,KAAKmB,gBAAgBpB,EAAEK,QAC9Bc,GACFlB,KAAKM,SAAS,OAAQ,CAAEC,OAAQ,CAAEC,MAAOT,EAAGI,KAAMH,KAAKC,YAAaiB,KAAMA,KAE5EnB,EAAEsB,iBAGJE,MAAMxB,GACJ,IAAImB,EAAOlB,KAAKmB,gBAAgBpB,EAAEK,QAC9Bc,IACFA,EAAKE,UAAUI,OAAO,+BACtBxB,KAAKM,SAAS,QAAS,CAAEC,OAAQ,CAAEC,MAAOT,EAAGI,KAAMH,KAAKC,YAAaiB,KAAMA,MAI/Ef,KAAKJ,GACHC,KAAKM,SAAS,OAAQ,CAAEC,OAAQ,CAAEC,MAAOT,EAAGI,KAAMH,KAAKC,eAGzDiB,KAAKnB,GACH,IAAImB,EAAOlB,KAAKmB,gBAAgBpB,EAAEK,QAC9Bc,GACFlB,KAAKM,SAAS,OAAQ,CAAEC,OAAQ,CAAEC,MAAOT,EAAGI,KAAMH,KAAKC,YAAaiB,KAAMA,KAI9EO,IAAI1B,GACFC,KAAKK,aAAY,GACjBL,KAAKM,SAAS,MAAO,CAAEC,OAAQ,CAAEC,MAAOT,EAAGI,KAAMH,KAAKC,eACtDD,KAAKS,QAAQC,UAAUc,OAAOxB,KAAKY,YAAYC,aAGjDM,gBAAgBf,GACd,YAAYsB,YAAYxB,KAAKgB,GAAQA,EAAKS,SAASvB,IAGrDC,YAAYuB,GAER5B,KAAK0B,YAAYG,QADfD,EACuBV,IACvBA,EAAKE,UAAUT,IAAI,uBAGIO,IACvBA,EAAKE,UAAUI,OAAO,sBACtBN,EAAKE,UAAUI,OAAO,2CAjFrBM,QAAU,CAAC,UACXC,QAAU,CACf,CAAC,UAAW,gCAEPlB,YAAc,CACnB,CAAC,UAAW,6BACZ,CAAC,UAAW,2BACZ,CAAC,UAAW,6BACZ,CAAC,UAAW,uBACZ,CAAC,UAAW,uBACZ,CAAC,UAAW"}